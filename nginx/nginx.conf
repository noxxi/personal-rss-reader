server {
        include /etc/nginx/default-server/listen-ssl.conf;
        server_name myrss.example;
        ssl_certificate /etc/nginx/ssl/myrss-cert.pem;
        ssl_certificate_key /etc/nginx/ssl/myrss-key.pem;

        # Secret path-based access (replace YOUR-SECRET-HERE with actual secret)
        location /YOUR-SECRET-HERE/ {
                # Strip the secret prefix when proxying to backend
                proxy_pass http://127.0.0.1:3000/;

                # Rewrite absolute /api/ URLs in responses to include secret prefix
                sub_filter '/api/' '/YOUR-SECRET-HERE/api/';
                sub_filter_once off;
                sub_filter_types text/html application/javascript text/css;

                # Standard proxy headers
                proxy_set_header Host $host;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header X-Forwarded-Proto $scheme;
        }

        # Return 404 for root and any other paths
        location / {
                return 404;
        }
}

